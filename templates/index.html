{% extends "base.html" %}
{% block title %}Página Principal{% endblock %}

{% block content %}
<div class="panel-header panel-header-sm"></div>

<div class="container mt-5" style="background-color: #f4f5f7; padding: 30px; border-radius: 10px;">
    <h2 class="text-primary">Resumen de Neumáticos</h2>

    {% if usuarios %}
    <!-- Formulario de selección de usuario -->
    <form method="GET" action="">
        <div class="form-group">
            <label for="usuario_id" class="text-primary">Selecciona un usuario para ver su resumen:</label>
            <select name="usuario_id" id="usuario_id" class="form-control" onchange="this.form.submit()">
                <option value="">Selecciona un usuario</option>
                {% for usuario in usuarios %}
                    <option value="{{ usuario.id }}" {% if selected_user.id == usuario.id %}selected{% endif %}>
                        {{ usuario.first_name }} {{ usuario.last_name }} ({{ usuario.email }})
                    </option>
                {% endfor %}
            </select>
        </div>
    </form>
    {% endif %}

    <h4 class="text-primary mt-4">Mostrando datos de: {{ selected_user.first_name }} {{ selected_user.last_name }}</h4>

    <!-- Tabla de neumáticos totales -->
    <div class="row mt-4">
        <div class="col-md-12">
            <table class="table table-bordered table-hover">
                <thead class="thead-light">
                    <tr>
                        <th>Total de Neumáticos</th>
                        <th>Operativos</th>
                        <th>No Operativos</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ total_neumaticos }}</td>
                        <td>{{ operativos }}</td>
                        <td>{{ no_operativos }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Tabla de huellas -->
    <div class="row mt-4">
        <div class="col-md-12">
            <h4>Huella de los Neumáticos Operativos</h4>
            <table class="table table-bordered table-hover">
                <thead class="thead-light">
                    <tr>
                        <th>Huella 0 a ≤3 mm</th>
                        <th>Huella >3 a ≤6 mm</th>
                        <th>Huella ≥6 mm</th> <!-- Aseguramos que aquí sea >=6 -->
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="background-color: red;">{{ huella_0_3 }}</td>
                        <td style="background-color: yellow;">{{ huella_3_6 }}</td>
                        <td style="background-color: green;">{{ huella_6_mas }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Tabla de requerimientos de servicio -->
    <div class="row mt-4">
        <div class="col-md-12">
            <h4>Requerimiento de Servicios por Vehículos</h4>
            <table class="table table-bordered table-hover">
                <thead class="thead-light">
                    <tr>
                        <th>Alineación</th>
                        <th>Balanceo</th>
                        <th>Rotación</th>
                        <th>Montura</th>
                        <th>Calibración</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="#">{{ servicios_por_vehiculo.alineacion }}</a></td>
                        <td><a href="#">{{ servicios_por_vehiculo.balanceo }}</a></td>
                        <td><a href="#">{{ servicios_por_vehiculo.rotacion }}</a></td>
                        <td><a href="#">{{ servicios_por_vehiculo.montura }}</a></td>
                        <td><a href="#">{{ servicios_por_vehiculo.calibracion }}</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}
